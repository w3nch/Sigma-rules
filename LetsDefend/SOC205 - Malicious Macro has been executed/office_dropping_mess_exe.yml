title: Office Macro Spawning PowerShell
id: 6d3c9d2e-1f9a-4a7e-9f8e-ps-macro-chain
status: experimental
description: Detects Microsoft Office applications spawning PowerShell, commonly seen in malicious macro execution
author: wrench
date: 2026/01/28
logsource:
  category: process_creation
  product: windows
detection:
  selection_parent:
    ParentImage|endswith:
      - '\WINWORD.EXE'
      - '\EXCEL.EXE'
  selection_child:
    Image|endswith:
      - '\powershell.exe'
      - '\cmd.exe'
  condition: selection_parent and selection_child
level: high
tags:
  - attack.execution
  - attack.t1059
  - attack.t1204